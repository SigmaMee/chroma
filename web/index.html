<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Chroma - Colour Alchemy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Generate accessible design tokens from a single color with WCAG compliance checking" />
    <meta name="theme-color" content="#5a7dff" />
    <link rel="icon" type="image/svg+xml" href="./assets/chromaLogo.svg" />
    <link rel="stylesheet" href="./styles.css" />
    <!-- Fallback message for very old browsers -->
    <script>
      // Check for essential browser features
      if (!window.CSS || !window.CSS.supports || !('classList' in document.createElement('div'))) {
        document.addEventListener('DOMContentLoaded', function() {
          document.body.innerHTML = '<div style="padding: 40px; text-align: center; font-family: sans-serif;"><h1>Browser Not Supported</h1><p>Please use a modern browser like Chrome, Firefox, Safari, or Edge.</p></div>';
        });
      }
    </script>
  </head>
  <body>
    <!-- Skip to main content for screen readers -->
    <a href="#mainContent" class="skip-to-main">Skip to main content</a>
    
    <!-- Welcome Page -->
    <div class="welcome-page" id="welcomePage">
      <div class="welcome-container">
        <svg width="10rem" height="10rem" viewBox="0 0 320 320" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M213.68 226.667V119.547H106.587V226.667M213.627 173.093C213.786 165.966 212.519 158.879 209.902 152.248C207.284 145.617 203.369 139.576 198.384 134.479C193.4 129.382 187.448 125.333 180.877 122.568C174.306 119.803 167.249 118.379 160.12 118.379C152.991 118.379 145.934 119.803 139.363 122.568C132.792 125.333 126.84 129.382 121.856 134.479C116.871 139.576 112.955 145.617 110.338 152.248C107.721 158.879 106.454 165.966 106.613 173.093C106.926 187.077 112.7 200.383 122.7 210.163C132.701 219.943 146.132 225.419 160.12 225.419C174.107 225.419 187.539 219.943 197.54 210.163C207.54 200.383 213.314 187.077 213.627 173.093ZM44.8 226.667L160.107 26.64L275.467 226.667H44.8ZM93.3333 275.467C108.503 284.36 125.281 290.164 142.703 292.546C160.125 294.929 177.846 293.841 194.846 289.347C211.846 284.852 227.789 277.039 241.757 266.358C255.725 255.677 267.443 242.338 276.235 227.11C285.027 211.882 290.721 195.065 292.987 177.628C295.253 160.191 294.048 142.477 289.441 125.508C284.834 108.538 276.916 92.6472 266.142 78.7501C255.369 64.8531 241.953 53.2243 226.667 44.5333C196.059 27.1311 159.81 22.5417 125.831 31.7668C91.8524 40.9919 62.9016 63.2824 45.2967 93.7741C27.6918 124.266 22.8622 160.483 31.8616 194.522C40.8611 228.562 62.9591 257.66 93.3333 275.467Z" stroke="var(--accent)" stroke-width="8" stroke-miterlimit="5.5" stroke-linejoin="bevel"/>
        </svg>
        <h1>Welcome to Chroma</h1>
        <p class="welcome-subtitle" id="welcomeSubtitle">Chroma is a colour alchemist. It transmutes a single colour in a full set of tokens including primary and neutral colour palettes and semantic token sets for light and dark mode. Currently in BETA</p>
        
        <div class="welcome-input-section">
          <label for="welcomePrimaryColor">Choose your primary colour</label>
          <div class="welcome-input-group">
            <div class="welcome-picker-wrapper">
              <input
                id="welcomePrimaryColor"
                type="color"
                value="#3366FF"
                class="welcome-color-picker"
                aria-label="Pick a primary color"
              />
            </div>
            <input
              id="welcomePrimaryHex"
              type="text"
              value="#3366FF"
              maxlength="7"
              placeholder="#3366FF"
              class="welcome-hex-input"
              aria-label="Enter hex color code"
            />
            <div 
              class="welcome-swatch" 
              id="welcomeSwatch" 
              title="Click to pick a color"
              role="button"
              tabindex="0"
              aria-label="Color swatch, click to open color picker"
            ></div>
          </div>
          
          <div id="recentColors" class="recent-colors hidden">
            <div class="recently-used-label">Recently used</div>
            <div id="recentColorsGrid" class="recent-colors-grid"></div>
          </div>
        </div>

        <button 
          id="welcomeGenerateBtn" 
          class="welcome-cta"
          aria-label="Generate design tokens from selected color"
        >Begin the transmutation</button>
      </div>
      <footer>
        <p>
          Developed by <a href="https://www.linkedin.com/in/stmndesigner/">Stefanos Monastiridis</a>. All rights reserved.
        </p>
      </footer>
    </div>

    <!-- Main App -->
    <div class="app hidden" id="mainApp">
      <a id="mainContent"></a>
      <header>
        <div>
          <h1>Chroma </h1>
          <p class="subtitle">Colour Alchemy</p></div>
        <div class="badge">BETA</div>
      </header>

      <div class="layout-container">
        <!-- Row 1: Inputs & Actions -->
        <div class="primary-menu">
          <div class="primary-color-input">
            <label for="primaryColor">Primary colour (hex)</label>
          
              <input
                id="primaryColor"
                value="#3366FF"
                maxlength="7"
                placeholder="#3366FF"
              />
              <span class="swatch" id="primarySwatch"></span>
              <input type="color" id="primaryColorPicker" value="#3366FF" />
          
            </div>
            
            <div class="compliance-toggle-wrapper">
              <label for="complianceToggle">Contrast compliance</label>
              <div class="toggle-group">
                <button class="toggle-btn active" data-level="AA">AA</button>
                <button class="toggle-btn" data-level="AAA">AAA</button>
              </div>
            </div>

          <input
            type="hidden"
            id="greyscaleSaturationValue"
            value="8"
          />
          <input type="hidden" id="derivedHex" value="" />
          <span id="derivedSwatch" class="hidden"></span>

          <div class="button-container">
            <button id="reset">Reset</button>
            <button class="primary" id="generate">
              <span class="btn-text">Generate tokens</span>
              <span class="btn-spinner hidden">
                <ion-icon name="hourglass-outline" class="spin-icon"></ion-icon>
                Generating...
              </span>
            </button>
            
          </div>
        </div>

        <!-- Row 2: Two columns -->
        <div class="bottom-row">
          <!-- Column 1: Scales & Matrices -->
          <div class="column column-1">
            <section class="card">
              <div>
                <div class="options-heading">Options</div>
                <div class="option-section">
                  <div class="option-label">
                    Harmony mode
                    <span class="helper">(Choose tint color relationship)</span>
                  </div>
                  <div class="harmony-cards">
                    <!-- Monochromatic -->
                    <div class="harmony-card">
                      <div class="harmony-header">
                        <img src="assets/Unity.svg" alt="Unity icon" class="harmony-icon" />
                        <h3>Monochromatic</h3>
                        <p class="harmony-description">Unified, pure tonal variation. All neutrals share identical temperature.</p>
                      </div>
                      <div class="harmony-swatches">
                        <button class="harmony-swatch active" data-mode="primary" data-variant="" title="Monochromatic (same hue)">
                          <span class="swatch-color" style="background: #8B95A7;"></span>
                        </button>
                      </div>
                    </div>

                    <!-- Complementary -->
                    <div class="harmony-card">
                      <div class="harmony-header">
                        <img src="assets/Opposition.svg" alt="Opposition icon" class="harmony-icon" />
                        <h3>Complementary</h3>
                        <p class="harmony-description">Maximum contrast, opposing warmth. Creates dramatic cool vs warm neutrals.</p>
                      </div>
                      <div class="harmony-swatches">
                        <button class="harmony-swatch" data-mode="complimentary" data-variant="" title="Complementary (180°)">
                          <span class="swatch-color" style="background: #A78B92;"></span>
                        </button>
                      </div>
                    </div>

                    <!-- Analogous -->
                    <div class="harmony-card">
                      <div class="harmony-header">
                        <img src="assets/Harmony.svg" alt="Harmony icon" class="harmony-icon" />
                        <h3>Analogous</h3>
                        <p class="harmony-description">Harmonious, gentle variation. Subtle temperature shift within same color family.</p>
                      </div>
                      <div class="harmony-swatches">
                        <button class="harmony-swatch" data-mode="analogous" data-variant="plus" title="Analogous +30°">
                          <span class="swatch-color" style="background: #928BA7;"></span>
                        </button>
                        <button class="harmony-swatch" data-mode="analogous" data-variant="minus" title="Analogous -30°">
                          <span class="swatch-color" style="background: #8BA0A7;"></span>
                        </button>
                      </div>
                    </div>

                    <!-- Triadic -->
                    <div class="harmony-card">
                      <div class="harmony-header">
                        <img src="assets/Vibrance.svg" alt="Vibrance icon" class="harmony-icon" />
                        <h3>Triadic</h3>
                        <p class="harmony-description">Balanced but vibrant, evenly spaced. Moderate contrast with balanced temperature.</p>
                      </div>
                      <div class="harmony-swatches">
                        <button class="harmony-swatch" data-mode="triadic" data-variant="plus" title="Triadic +120°">
                          <span class="swatch-color" style="background: #A78B92;"></span>
                        </button>
                        <button class="harmony-swatch" data-mode="triadic" data-variant="minus" title="Triadic -120°">
                          <span class="swatch-color" style="background: #92A78B;"></span>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div>
                  <div class="option-label">
                    Tint amount
                    <span class="helper">(Low, Mid, or High)</span>
                  </div>
                  <div class="switch-row">
                    <button id="tintAmountSwitch-low" class="tint-switch active" data-value="low">Low</button>
                    <button id="tintAmountSwitch-mid" class="tint-switch" data-value="mid">Mid</button>
                    <button id="tintAmountSwitch-high" class="tint-switch" data-value="high">High</button>
                  </div>
                </div>
              </div>
            </section>

            <section class="card scale-card">
             
              <div class="section-header-with-controls">
                <h3 class="section-heading">Palettes</h3>
                <button id="palette-settings-btn" class="palette-settings-btn" aria-label="Palette generation settings">
                  <ion-icon name="settings-outline"></ion-icon>
                </button>
              </div>
              
             <div class="subsection-label">Neutral</div>
              <div class="scale-grid" id="scale-grid">
                <div class="empty-state">
                  <ion-icon name="color-palette-outline"></ion-icon>
                  <h3>No tokens yet</h3>
                  <p>Generate tokens to preview the neutral color scale</p>
                </div>
              </div>
              

              
              <div class="subsection-label">Primary</div>
              <div class="scale-grid" id="primary-grid">
                <div class="empty-state">
                  <ion-icon name="brush-outline"></ion-icon>
                  <h3>No tokens yet</h3>
                  <p>Generate tokens to preview the primary color scale</p>
                </div>
              </div>
              
            </section>

            <section class="card">
              <h3 class="section-heading">Semantic Mapping</h3>
              <p class="helper helper-no-margin">Override the default semantic token mappings from the palettes above.</p>
              <div id="semantic-mapping-container">
                <div class="empty-state">
                  <ion-icon name="options-outline"></ion-icon>
                  <h3>No semantic mappings</h3>
                  <p>Generate tokens first, then customize semantic color assignments</p>
                </div>
              </div>
            </section>

            <section class="card matrix-card hidden">
              <div class="status">
                <span>WCAG contrast matrix (background × foreground)</span>
                <span class="pill" id="matrix-pass-count">0</span>
              </div>
              <div class="matrix-grid" id="matrix-grid">
                <p class="helper">Generate tokens to evaluate combinations.</p>
              </div>
              <p class="matrix-note" id="matrix-note">
                Rows are backgrounds, columns are foregrounds. Green = passes normal text threshold, Blue = passes large text only, Red = fails.
              </p>
            </section>

            <section class="card hidden">
              <div class="status">
                <span>Primary color contrast matrix (background × foreground)</span>
                <span class="pill" id="primary-matrix-pass-count">0</span>
              </div>
              <div class="matrix-grid" id="primary-matrix-grid">
                <p class="helper">Generate tokens to evaluate combinations.</p>
              </div>
              <p class="matrix-note" id="primary-matrix-note">
                Rows are primary backgrounds, columns are neutral + white foregrounds. Green = passes normal text threshold, Blue = passes large text only, Red = fails.
              </p>
            </section>
          </div>

          <!-- Column 2: Tabs (Preview / JSON Output) -->
          <div class="column column-2">
            <div class="tabs-container">
              <div class="tabs-header" role="tablist" aria-label="Token views">
                <button class="tab-button active" data-tab="preview" role="tab" aria-selected="true" aria-controls="preview-tab" aria-label="Preview tokens"><ion-icon name="eye-outline" aria-hidden="true"></ion-icon></button>
                <button class="tab-button" data-tab="wcag" role="tab" aria-selected="false" aria-controls="wcag-tab" aria-label="WCAG Validation"><ion-icon name="accessibility-outline" aria-hidden="true"></ion-icon></button>
                <button class="tab-button" data-tab="output" role="tab" aria-selected="false" aria-controls="output-tab" aria-label="JSON Output"><ion-icon name="code-slash-outline" aria-hidden="true"></ion-icon></button>
              </div>

              <!-- Preview Tab -->
              <div class="tab-content active" id="preview-tab" role="tabpanel" aria-labelledby="preview">
                <section class="card semantic-preview">
                  <div class="status">
                    <span>Semantic tokens preview</span>
                    <div class="toggle-group" role="group" aria-label="Theme selection">
                      <button class="toggle-btn active" data-theme="light" aria-pressed="true">Light</button>
                      <button class="toggle-btn" data-theme="dark" aria-pressed="false">Dark</button>
                    </div>
                  </div>
                  <div id="semantic-preview-container" aria-live="polite">
                    <p class="helper">Generate tokens to preview semantic surfaces and text.</p>
                  </div>
                </section>
              </div>

              <!-- WCAG Validation Tab -->
              <div class="tab-content" id="wcag-tab">
                <section class="card">
                  <div class="status">
                    <span>Semantic tokens WCAG validation</span>
                    <span class="pill" id="semantic-matrix-pass-count">0</span>
                  </div>
                  <div class="matrix-grid" id="semantic-matrix-grid">
                    <p class="helper">Generate tokens to validate semantic color combinations.</p>
                  </div>
                  <p class="matrix-note" id="semantic-matrix-note">
                    Rows are semantic surfaces, columns are semantic text/outline tokens. Green = passes normal text threshold, Blue = passes large text only, Red = fails.
                  </p>
                </section>
              </div>

              <!-- JSON Output Tab -->
              <div class="tab-content" id="output-tab">
                <section class="card">
                  <div class="status">
                    <span>Token output</span>
                    <div class="flex-gap-center">
                      <span class="pill" id="token-count">0</span>
                      <div class="output-format-toggle">
                        <button class="format-btn active" data-format="json">JSON</button>
                        <button class="format-btn" data-format="css">CSS</button>
                      </div>
                    </div>
                  </div>
                  <textarea
                    id="output"
                    placeholder="Generate tokens to view output."
                    readonly
                  ></textarea>
                  <div class="actions">
                    <button id="copy" disabled>Copy output</button>
                    <button id="download" disabled aria-label="Download tokens as JSON file">
                      <ion-icon name="download-outline" aria-hidden="true"></ion-icon>
                      Download JSON
                    </button>
                  </div>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Palette Settings Modal -->
      <div id="palette-settings-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
          <div class="modal-header">
            <h2>Palette Generation Settings</h2>
            <button id="modal-close-btn" class="modal-close-btn" aria-label="Close settings">
              <ion-icon name="close-outline"></ion-icon>
            </button>
          </div>
          
          <!-- Modal Tabs -->
          <div class="modal-tabs">
            <button class="modal-tab-btn active" data-tab="neutral-settings" aria-label="Neutral palette settings">
              Neutral
            </button>
            <button class="modal-tab-btn" data-tab="primary-settings" aria-label="Primary palette settings">
              Primary
            </button>
          </div>
          
          <div class="modal-body">
            <!-- Neutral Palette Settings -->
            <div id="neutral-settings" class="modal-tab-content active">
              <div class="modal-control-group">
                <label class="modal-control-label">Scale range</label>
                <div class="slider-container">
                  <div class="slider-inputs">
                    <div class="slider-input-group">
                      <label>Lighter</label>
                      <input type="range" id="neutral-slider-before" class="slider-input" min="2" max="5" value="5" dir="rtl" />
                      <span class="slider-value">5</span>
                    </div>
                    <div class="slider-input-group">
                      <label>Darker</label>
                      <input type="range" id="neutral-slider-after" class="slider-input" min="2" max="6" value="6" />
                      <span class="slider-value">6</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Easing controls for neutral -->
              <div class="modal-control-group">
                <label class="modal-control-label">Curve type</label>
                <select id="neutral-easing-curve-type" class="select-input">
                  <option value="linear">Linear</option>
                  <option value="quadratic">Quadratic</option>
                  <option value="cubic" selected>Cubic</option>
                  <option value="quartic">Quartic</option>
                  <option value="quintic">Quintic</option>
                </select>
              </div>
              <div class="modal-control-group">
                <label class="modal-control-label">Easing type</label>
                <select id="neutral-easing-easing-type" class="select-input">
                  <option value="in">In (accelerating)</option>
                  <option value="out">Out (decelerating)</option>
                  <option value="inOut" selected>In-Out (smooth)</option>
                </select>
              </div>
              <div class="modal-control-group">
                <label class="modal-control-label">Palette preview</label>
                <div id="neutral-preview-strip" class="palette-preview-strip"></div>
              </div>
            </div>
            
            <!-- Primary Palette Settings -->
            <div id="primary-settings" class="modal-tab-content">
              <div class="modal-control-group">
                <label class="modal-control-label">Scale range</label>
                <div class="slider-container">
                  <div class="slider-inputs">
                    <div class="slider-input-group">
                      <label>Lighter</label>
                      <input type="range" id="primary-slider-before" class="slider-input" min="2" max="5" value="5" dir="rtl" />
                      <span class="slider-value">5</span>
                    </div>
                    <div class="slider-input-group">
                      <label>Darker</label>
                      <input type="range" id="primary-slider-after" class="slider-input" min="2" max="6" value="6" />
                      <span class="slider-value">6</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Easing controls for primary -->
              <div class="modal-control-group">
                <label class="modal-control-label">Curve type</label>
                <select id="primary-easing-curve-type" class="select-input">
                  <option value="linear">Linear</option>
                  <option value="quadratic">Quadratic</option>
                  <option value="cubic" selected>Cubic</option>
                  <option value="quartic">Quartic</option>
                  <option value="quintic">Quintic</option>
                </select>
              </div>
              <div class="modal-control-group">
                <label class="modal-control-label">Easing type</label>
                <select id="primary-easing-easing-type" class="select-input">
                  <option value="in">In (accelerating)</option>
                  <option value="out">Out (decelerating)</option>
                  <option value="inOut" selected>In-Out (smooth)</option>
                </select>
              </div>
              <div class="modal-control-group">
                <label class="modal-control-label">Palette preview</label>
                <div id="primary-preview-strip" class="palette-preview-strip"></div>
              </div>
            </div>
          </div>
          
          <div class="modal-footer">
            <button id="modal-apply-btn" class="btn-primary">Apply</button>
            <button id="modal-cancel-btn" class="btn-secondary">Cancel</button>
          </div>
        </div>
      </div>

      <footer>
        <p>
          Developed by <a href="https://www.linkedin.com/in/stmndesigner/">Stefanos Monastiridis</a>. All rights reserved.
        </p>
      </footer>
    </div>

    <script type="module" src="./config-loader.js"></script>
    <script type="module" src="./main.js"></script>
    <script type="module" src="./layout.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js" crossorigin="anonymous"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js" crossorigin="anonymous"></script>
  </body>
</html>

